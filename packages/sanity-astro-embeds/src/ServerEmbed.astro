---
import { parseEmbedUrl } from "./parseEmbedUrl";
import { ClientEmbed } from "./ClientEmbed";

export interface Props {
  id?: string;
  url?: string;
}

const { id, url } = Astro.props;
const providerData = url ? parseEmbedUrl(url) : undefined;
if (!providerData) {
  throw new Error("No matching provider data found");
}

if (!url && !id) {
  throw new Error("Please provide an ID or Url to embed");
}

const { provider, id: providerId } = providerData;

const { id: embedId } = provider.getRenderProps(url || id || "");

if (!embedId) {
  throw new Error("Embed ID could not be inferred from the inputs");
}
---

<div>
  <ClientEmbed id={embedId} providerId={providerId} client:visible />
</div>
